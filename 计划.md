MDA 元数据驱动表单系统构建计划
一、计划总目标
搭建一套轻量化但贴近企业级 ERP 体验的 MDA 表单系统，支持 “元数据配置表单字段 / 布局 / 规则”，无需改代码即可扩展字段、适配多端，最终能作为小型低代码表单工具使用。
二、分阶段执行计划
阶段 1：基础验证阶段（1 天）
核心目标
跑通现有代码，验证 MDA 核心逻辑（元数据解析 + 动态渲染），解决环境 / 运行问题。
关键任务
完成 Python 环境配置（确认 3.6+ 版本、tkinter 可用）；
创建并核对 erp_form_metadata.xml 和 mda_form_engine.py 文件（确保路径 / 文件名无错）；
成功运行代码，验证基础效果：
PC 端显示 “测试增量元数据” 文本框；
输入长度限制 500 字符生效；
移动端 / 平板端隐藏字段生效。
产出物
可正常运行的基础 MDA 表单程序；
环境问题排查笔记（记录遇到的报错及解决方法）。
阶段 2：功能扩展阶段（2-3 天）
核心目标
模拟 ERP 真实场景，扩展字段类型、校验规则、多字段支持，完善元模型。
关键任务
表格
子任务	具体内容	产出物
1. 新增字段类型	基于元数据新增 “下拉框（ComboBox）”“金额字段（MoneyField）”：
① 在 XML 中新增 <ComboBox>/<MoneyField> 元模型节点；
② 改造引擎代码，解析新字段类型并渲染对应控件；
③ 示例：新增 “付款方式” 下拉框（现金 / 转账 / 承兑）。	支持多字段类型的 XML 元数据 + 改造后的引擎代码
2. 新增业务校验规则	基于元数据添加字段校验（非空、数字格式）：
① 在 XML 中新增 <Validation> 节点（如 <Required>1</Required> 表示非空）；
② 引擎解析校验规则，表单提交时触发校验；
③ 示例：“测试增量元数据” 字段设为非空。	带校验规则的元数据 + 校验逻辑代码
3. 支持多字段配置	在 XML 中新增 “订单编号”“供应商名称” 字段，引擎自动渲染多个字段，保持布局独立。	多字段 XML 元数据 + 渲染正常的多字段表单
4. 完善多端适配	优化 VisibleExt 解析逻辑：
① 支持 111（全端显示）、010（仅移动端）等编码；
② 移动端标签页适配控件大小（缩小布局）。	适配更灵活的多端渲染逻辑
阶段 3：进阶优化阶段（3-4 天）
核心目标
提升系统实用性，增加元数据管理、数据持久化、界面美化，贴近真实 ERP 体验。
关键任务
表格
子任务	具体内容	产出物
1. 元数据可视化管理	新增 “元数据编辑界面”：
① 用 tkinter 做简单的 XML 配置编辑器（无需手写 XML）；
② 支持可视化修改字段名称、位置、可见性；
③ 修改后自动保存到 XML 文件。	元数据可视化编辑界面 + 配置保存逻辑
2. 表单数据持久化	新增数据保存 / 加载功能：
① 将表单输入的内容保存到 JSON 文件 / 轻量数据库（SQLite）；
② 打开表单时自动加载历史数据；
③ 示例：保存 “测试增量元数据” 字段内容。	数据存储逻辑 + 历史数据加载功能
3. 界面美化 & ERP 风格	优化表单样式：
① 模拟 ERP 单据样式（标题栏、操作按钮、分隔线）；
② 新增 “保存 / 重置 / 提交” 按钮，绑定对应逻辑；
③ 适配不同屏幕分辨率的布局自适应。	ERP 风格的表单界面 + 操作按钮逻辑
4. 元数据导入 / 导出	支持 XML 元数据的导入（加载配置）、导出（备份配置），模拟 ERP 单据模板迁移。	导入 / 导出功能代码 + 测试用的元数据模板文件
阶段 4：落地部署阶段（1-2 天）
核心目标
将系统打包成可执行文件，编写文档，方便非技术人员使用。
关键任务
打包可执行文件：用 pyinstaller 将 Python 代码打包成 exe（Windows）/app（Mac），无需安装 Python 即可运行；
命令：pip install pyinstaller → pyinstaller -F -w mda_form_engine.py（-F 单文件，-w 无控制台）。
编写使用文档：
文档包含：运行方式、元数据配置说明、字段类型 / 校验规则编码表、常见问题解决。
测试 & 修复 bug：
测试场景：新增字段、修改布局、多端显示、数据保存 / 加载；
修复布局错乱、校验失效、数据保存失败等问题。
产出物
可直接运行的 exe/app 可执行文件；
完整的使用文档；
测试报告（bug 修复记录）。
阶段 5：扩展规划（可选）
核心目标
向企业级低代码平台靠拢，预留扩展空间。
可选任务
支持更多元模型（按钮、表格、子单据体）；
对接真实 ERP 数据库（如 MySQL/Oracle）；
增加权限控制（不同角色看到不同字段）；
开发 Web 版本（用 Flask/FastAPI 替代 tkinter，支持浏览器访问）。
三、资源 & 时间预估
表格
资源类型	具体内容
技术栈	Python 3.6+、tkinter（界面）、xml.etree（解析）、SQLite（可选）、pyinstaller（打包）
总耗时	基础版（阶段 1+2）：3-5 天；完整版（阶段 1-4）：7-12 天
学习成本	新手可聚焦阶段 1-2，核心掌握 “元数据解析 + 动态渲染” 即可；进阶功能可按需学习。
四、风险 & 应对方案
表格
风险点	应对方案
引擎解析 XML 出错	① 给 XML 节点加默认值（如字段长度默认 200）；② 增加异常捕获，打印错误日志；③ 校验 XML 格式合法性。
界面布局错乱	① 改用相对布局（而非绝对像素）适配不同屏幕；② 限制表单窗口最小尺寸；③ 布局参数加范围校验（如 Left 不能为负数）。
打包 exe 体积过大	① 用 pyinstaller 加 -i 剔除无用依赖；② 分卷打包；③ 推荐新手先用源码运行，熟悉后再打包。
总结
计划核心逻辑：从 “跑通基础” 到 “扩展功能” 再到 “落地使用”，循序渐进，贴合新手学习节奏；
核心产出：一套可配置、可扩展、可落地的轻量化 MDA 表单系统，完美复刻 ERP 元数据驱动的核心思想；
关键重点：始终保持 “元数据（XML）” 和 “引擎代码” 分离，所有功能扩展优先改配置，而非改引擎核心逻辑。
你可以先从阶段 1开始，跑通基础代码后，再根据需求逐步推进后续阶段。如果在某一阶段遇到具体问题（比如新增下拉框时引擎解析出错），我可以针对性帮你修改代码、解决问题。
